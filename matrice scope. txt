Parfait â€” je te fais une matrice claire et exploitable des ports Ã  ouvrir entre Ansible AAP, Red Hat Satellite et les Capsules, en distinguant Satellite connectÃ© vs Satellite disconnected (air-gapped), exactement comme demandÃ©.
Je mâ€™appuie sur la doc officielle Red Hat Satellite 6.17 â€“ Port and Firewall Requirements ï¿½ et sur les flux AAP standard.
Red_Hat_Satellite-6.17-Installing_Satellite_Server_in_a_connected_network_environment-en-US.pdf None
1ï¸âƒ£ Flux Ansible AAP â†” Satellite / Capsule (cas gÃ©nÃ©ral)
ğŸ¯ Objectif
Inventaires dynamiques Satellite
ExÃ©cution de jobs Ansible depuis AAP
Callback / rÃ©sultats
API & Remote Execution
ğŸ”“ Ports requis
Source
Destination
Port
Proto
Usage
AAP Controller / Execution Node
Satellite Server
443
TCP
API Satellite, inventories dynamiques, credentials, facts
AAP Controller / Execution Node
Capsule
443
TCP
API Capsule (si REX ou content via Capsule)
Satellite
AAP Controller
443
TCP
Callback Ansible, job events
AAP Execution Node
Managed Hosts
22
TCP
SSH (Ansible push)
Managed Hosts
AAP
443
TCP
Callback (ansible-runner, AWX callback)
ğŸ‘‰ Minimum vital AAP â†” Satellite : TCP 443 uniquement
2ï¸âƒ£ Flux Satellite â†” Capsule (connected & disconnected)
ğŸ”“ Ports obligatoires
Source
Destination
Port
Proto
Usage
Capsule
Satellite
443
TCP
API Satellite, sync metadata
Satellite
Capsule
443
TCP
Gestion Capsule, templates, REX
Satellite
Capsule
9090
TCP
Smart Proxy API
Capsule
Satellite
80 / 443
TCP
Content mirroring (selon config)
ğŸ“Œ 9090 = Smart Proxy obligatoire, souvent oubliÃ© par les Ã©quipes rÃ©seau.
3ï¸âƒ£ Flux Satellite Disconnected (Air-Gapped)
ğŸ”’ SpÃ©cificitÃ©s
âŒ Aucun accÃ¨s CDN Red Hat
âŒ Pas de console.redhat.com
âœ… Sync via export/import (ISS, ISO, rsync offline)
âœ… AAP reste interne
ğŸ”“ Ports internes uniquement
Source
Destination
Port
Proto
Usage
AAP
Satellite
443
TCP
API / Inventaires
Satellite
Capsule
443
TCP
Content & API
Satellite
Capsule
9090
TCP
Smart Proxy
Capsule
Hosts
443 / 80
TCP
Content
AAP
Hosts
22
TCP
Ansible
ğŸš« Aucun port sortant Internet requis
4ï¸âƒ£ Flux Satellite Connected
ğŸ”“ Ports sortants supplÃ©mentaires (Satellite uniquement)
Destination
Port
Usage
cdn.redhat.com
443
Sync contenu
subscription.rhsm.redhat.com
443
Subscriptions
console.redhat.com
443
Insights
connect.cloud.redhat.com
443
MQTT / telemetry
cert-api.access.redhat.com
443
Certs
âš ï¸ AAP nâ€™a PAS besoin dâ€™accÃ¨s Internet, mÃªme en Satellite connected.
5ï¸âƒ£ Remote Execution (optionnel mais frÃ©quent)
Push (SSH)
Source
Destination
Port
Satellite / Capsule
Hosts
22
Pull (MQTT â€“ trÃ¨s utilisÃ© en zones sÃ©curisÃ©es)
Source
Destination
Port
Hosts
Satellite / Capsule
1883 TCP
6ï¸âƒ£ RÃ©sumÃ© â€œone-pageâ€ pour rÃ©seau / sÃ©curitÃ©
âœ… Ports minimum Ã  ouvrir
Copy code

AAP â†’ Satellite : 443
Satellite â†” Capsule : 443, 9090
AAP â†’ Hosts : 22
Capsule â†’ Hosts : 443 (80 optionnel)
âŒ Ã€ ne PAS ouvrir
AAP â†’ Internet
Hosts â†’ Internet
Capsule â†’ Internet (en disconnected)
7ï¸âƒ£ Recommandation architecture (best practice)
AAP ne parle jamais directement aux repos
Tout passe par Satellite / Capsule
443 only policy possible (hors SSH)
Pull-REX + AAP = zÃ©ro flux entrant vers hosts
Si tu veux, je peux te fournir :
ğŸ”¹ une matrice flux Excel / CSV
ğŸ”¹ un schÃ©ma rÃ©seau ASCII ou PPT
ğŸ”¹ une version prÃªte ServiceNow / firewall request
ğŸ”¹ ou une comparaison CIS / PROD / DMZ
Dis-moi ğŸ‘